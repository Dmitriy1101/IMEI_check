# IMEI_check проверка IMEI телефона используя сервис 

### - Состоит из бота и бэкэнда на FastAPI
### - Все помещено в докер контейнер
### - Содержет контейнеры для тестирования

 - Далее команды будут для ос windows
 - Для установки и тестирования вам понадобится:
    -  `.env` файл в корне проекта для бэкэнда
        - Эта конфигурация включает данные для тестовой базы данных которая будет создана в контейнере.
            При желании можете указать свою тестовую базу данных(В этом случае пропустите пункт с созданием 
            базы в контейнере)
        ```
        DB_USER='dbuser'
        DB_PASS='pass'
        DB_HOST='host.docker.internal'
        DB_PORT='15432'
        DB_DB='dbname'
        DB_SCHEMA='test_back'
        REDIS_HOST='redis'
        REDIS_PORT='6379'
        REDIS_DB='1'
        TOKEN_SANDBOX='https://imeicheck.net/ Токен API Sandbox'
        TOKEN_LIVE='https://imeicheck.net/ Токен API Live'
        ```
    -  также `bot.env` вот тут: `tests\tools\bot.env` для тестирования бота нужно создать дополнительный файл
        - `API_TOKEN` тестовый токен из настроек бэкэнда
        ```
        API_HOST='host.docker.internal'
        API_PORT='58485'
        API_TOKEN='cf4gJ5Qovk2W0ZJ4zSth7SjweFsbfv7SNigImdzhVt3uue9bi3_UIyJPNtzNaEyJDHFaD6KYkHO-JMob'
        BOT_TOKEN='Токен телеграм бота'
        TEST='True'
        ```
        - сам репозиторий с ботом грузится находится сдесь `https://github.com/Dmitriy1101/test_telegramm_bot.git`

 - После создания файлов окружения надо запустить создание контейнеров:
    - `docker compose -f tests\tools\test-database.yaml up -d` -  создание контейнера с тестовой базой данных `Postgres`
    - `docker compose up -d --build ` - создание двух контейнеров бэкэнда
    - `docker compose -f tests\tools\bot.yaml up -d` - создание контейнера с ботом
    - Не важен но предпочтителен
 - Пояснения:
    - Так как разные сервисы будь то база данных, бэкэнд или телеграм бот могут распологаться в разных "местах" то мной выбран такой подход.
    - При запуске контейнера с бэкэндом автоматически запускаются миграции до последней версии 
    это сделано для удобства развертывания.
    - Параметр запроса `token` перемещен из параметров запроса в заголовки по соображениям безопасности.
    - Методы авторизации избыточные для маленькойго сервииса, я исходил из подхода, что сервис будет расширяться.
    - После запуска контейнера с бэком документацию можно увидеть тут:`http://127.0.0.1:58485/docs#/`
